define("bui/extensions/multiselect",["bui/common","jquery","bui/form","bui/overlay","bui/list","bui/data","bui/picker"],function(e,t,i){var n=(e("bui/common"),e("bui/extensions/search"),e("bui/extensions/multiselect/multilist"),e("bui/extensions/multiselect/multilistpicker"),e("bui/extensions/multiselect/multiselect"));i.exports=n}),define("bui/extensions/search",["jquery","bui/common","bui/form","bui/overlay","bui/list","bui/data"],function(e,t,i){function n(e){n.superclass.constructor.call(this,e)}var s=e("jquery"),r=e("bui/common"),l=e("bui/form");r.extend(n,r.Base),n.ATTRS={tpl:{value:'<p><input type="text" name="key"/> <button class="button button-small">\u786e\u5b9a</button></p>'}},r.augment(n,{createDom:function(){var e=this,t=s("<div></div>").append(e.get("tpl")),i=new l.Group({srcNode:t}).render();e.set("el",t),e.set("group",i)},renderUI:function(e){var t=e.get("el");t.before(this.get("el"))},bindUI:function(e){var t=this,i=t.get("el"),n=e.get("store"),s=t.get("group");i.find(".button").on("click",function(){n.load(s.getRecord())})}}),i.exports=n}),define("bui/extensions/multiselect/multilist",["jquery","bui/common","bui/list","bui/data"],function(e,t,i){function n(e,t,i){r.isFunction(e.set)?e.set(t,i):e[t]=i}var s=e("jquery"),r=e("bui/common"),l=r.Component,u=(e("bui/list"),r.prefix),o=u+"multilist-source",c=u+"multilist-target",a=u+"multilist-btn-right",m=u+"multilist-btn-left",d=l.Controller.extend({renderUI:function(){var e=this,t=e.get("source"),i=e.get("target");t=e._initControl(t,o),i=e._initControl(i,c),t.render(),i.render(),e.set("source",t),e.set("target",i)},_initControl:function(e,t){var i=this,n=i.get("el");return e.isController?(e.set("render",n.find("."+t)),e):(e.render=n.find("."+t),i._createControl(e))},_createControl:function(e){if(e.isController)return e;var t=e.multipleSelect||this.get("multipleSelect"),i=e.xclass||t?"listbox":"simple-list";return e.xclass=i,l.create(e,this)},bindUI:function(){var e=this,t=e.get("el"),i=e.get("source"),n=e.get("target"),r=t.find("."+a),l=t.find("."+m);r.on("click",function(){var t=i.getSelection();e.fire("selected",{items:t})!==!1&&(i.removeItems(t),n.addItems(t))}),l.on("click",function(){var t=n.getSelection();e.fire("unselected",{items:t})!==!1&&(n.removeItems(t),i.addItems(t))}),i.on("dblclick",function(t){var r=s(t.domTarget).closest("li"),l=i.getItemByElement(r);e.fire("selected",{items:[l]})!==!1&&(i.removeItem(l),n.addItem(l))}),n.on("dblclick",function(t){var r=s(t.domTarget).closest("li"),l=n.getItemByElement(r);e.fire("unselected",{items:[l]})!==!1&&(n.removeItem(l),i.addItem(l))})},_uiSetStore:function(e){var t=this,i=t.get("target"),n=i.get("idField");e.filter(function(e){var t=i.getItems(),s=!0;return r.each(t,function(t){return t[n]===e[n]?(s=!1,!1):void 0}),s})}},{ATTRS:{source:{value:{elCls:"bui-select-list"},shared:!1},target:{value:{elCls:"bui-select-list"},shared:!1},store:{setter:function(e){return n(this.get("source"),"store",e),e}},items:{setter:function(e){var t=new r.Data.Store({data:e});return this.set("store",t),e}},url:{setter:function(e){if(e){var t=new r.Data.Store({url:e,autoLoad:!0});return this.set("store",t),e}}},tpl:{value:'<div class="row"><div class="span5 '+o+'"></div><div class="span2 bui-multilist-action centered"><p><button  class="button button-small '+a+'" type="button">&gt;&gt;</button></p><p><button  class="button button-small '+m+'" type="button">&lt;&lt;</button></p></div><div class="span5 '+c+'"></div></div>'}}},{xclass:"multilist"});i.exports=d}),define("bui/extensions/multiselect/multilistpicker",["jquery","bui/overlay","bui/common","bui/picker","bui/list","bui/data"],function(e,t,i){var n=e("jquery"),s=e("bui/overlay").Dialog,r=e("bui/picker").Mixin,l=s.extend([r],{setSelectedValue:function(e){function t(){i._syncValue(e),s.off("load",t)}var i=this,n=i.get("innerControl"),s=n.get("store");!this.get("isInit")&&e&&(e=e.split(","),s.get("url")?s.on("load",t):i._syncValue(e))},_syncValue:function(e){var t=this,i=t.get("innerControl"),s=t._getTextField(),r=i.get("source").get("idField"),l=i.get("store"),u=l.getResult(),o=[],c=[];BUI.each(u,function(t){-1!==n.inArray(t[r],e)&&(o.push(t),c.push(t.text))}),n(s).val(c.join(",")),BUI.each(o,function(e){l.remove(e)}),i.get("target").setItems(o)},getSelectedValue:function(){var e=this,t=e.get("innerControl"),i=t.get("target");return e._getItemsValue(i)},getSelectedText:function(){var e=this,t=e.get("innerControl"),i=t.get("target");return e._getItemsText(i)},_getItemsText:function(e,t){return t||(t=e.get("items")),n.map(t,function(t){return e.getItemText(t)})},_getItemsValue:function(e,t){var i=e.get("idField");return t||(t=e.get("items")),n.map(t,function(t){return e.getValueByField(t,i)})}},{ATTRS:{success:{value:function(){var e=this;e.get("innerControl").fire(e.get("changeEvent")),this.close()}}}},{xclass:"multilist-picker"});i.exports=l}),define("bui/extensions/multiselect/multiselect",["jquery","bui/common","bui/list","bui/data","bui/overlay","bui/picker","bui/form"],function(e,t,i){var n=e("jquery"),s=e("bui/common"),r=s.Component,l=e("bui/extensions/multiselect/multilist"),u=e("bui/extensions/multiselect/multilistpicker"),o=e("bui/extensions/search"),c=s.prefix+"select-input",a=r.Controller.extend({initializer:function(){var e,t=this,i=t.get("search"),n=t.get("searchTpl"),s={};i&&(n&&(s.tpl=n),i=new o(s),e=[i]);var r=new l({items:t.get("items"),url:t.get("url"),plugins:e});t.set("multilist",r)},renderUI:function(){var e=this,t=e.get("el"),i=t.find("."+c),n=e.get("multilist"),s=new u({trigger:i,autoRender:!0,textField:i,valueField:e.get("valueField"),children:[n]});e.set("picker",s),e.set("textField",i)},bindUI:function(){var e=this,t=e.get("multilist");t.on("selected",function(t){var i=t.items;return e.fire("selected",{items:i})}),t.on("unselected",function(t){var i=t.items;return e.fire("unselected",{items:i})})}},{ATTRS:{elCls:{value:"bui-select"},searchTpl:{},search:{},url:{},items:{},source:{getter:function(){return this.get("multilist").get("source")}},target:{getter:function(){return this.get("multilist").get("target")}},valueField:{setter:function(e){return n(e)}},textField:{},tpl:{view:!0,value:'<input type="text" readonly="readonly" class="'+c+'"/><span class="x-icon x-icon-normal"><i class="icon icon-caret icon-caret-down"></i></span>'}}},{xclass:"multiselect"});i.exports=a});